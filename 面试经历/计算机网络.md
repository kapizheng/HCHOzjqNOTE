[TOC]

### 1、浏览器输入URL到显示的过程

https://www.cnblogs.com/Grace-zyy/p/6954626.html

https://zhuanlan.zhihu.com/p/113702574

https://zhuanlan.zhihu.com/p/134646537 	这个可以好好看看，特别是第一句

1、先运行DNS解析，IP地址MAC地址的区别，IP地址

2、调用TCP连接，TCP和UDP和三次握手，四次挥手

3、进行http协议通信，http状态码

4、浏览器渲染

1. HTTP解析
2. DNS查找域名
3. 传输层（TCP）发送
4. IP协议加入IP地址头部
5. 查找MAC（通过arp）也就是查找下一个物理地址在哪。
6. 进入交换机，交换机会有多个端口，如果MAC能找到对应的端口，数据就从该对应的端口走，如果MAC不能查找到对应的端口，就广播一次。

https://zhuanlan.zhihu.com/p/113702574

当IP地址都为0的时候表示默认网关，也就是说找不到缓存中的数据就跑去其他路由器中找。

### 2、OSI的七层模型和TCP五层模型

- 应用层：为应用程序提供网络服务

### 3、TCP和UDP

- TCP提供可靠传输，实行顺序控制，重发控制机制。还具备有流控制，拥塞控制提高网络利用率等纵多功能。重发机制有时候不好，例如打电话，如果丢包就会重发，这样子很难流畅传输人的声音。多播网络也使用udp。
- 确认应答，超时重传，TCP以段为单位发送数据，MSS（最大消息长度）最大消息长度正好是IP中不会被分片处理的最大数据长度。在3次握手的时候计算出，两端主机在发出建立连接的请求时，会在TCP首部中写入MSS选项，告诉对方主机的接口能适应的MSS大小，然后会在两者之间选择一个较小的值投入使用。
- 窗口控制提高速度，每次发送数据之后，不再需要等待应答，而是继续发送数据，窗口大小就是指无需等待确认应答可以继续发送数据的最大值。实现了用大量缓冲区，通过对多个段同时进行确认应答的功能。
- UDP不提供可靠传输，可以确保发送信息的大小，却不能保证消息一定会到达。UDP主要用于高速传输和实时性有较高要求的通信或者广播通信。UDP不提供复杂的控制机制，在出现网络拥堵的情况下，UDP也无法进行流量控制等避免网络拥塞的行为。丢包不重发。应用场景：包总量比较少的通信，视频，音频等多媒体通信，广播通信，物联网，移动通信，APP和HTTP。
- UDP一般用在哪：媒体流，游戏，即时通讯，多播。
- TCP的头部信息比UDP多。

### 4、请讲讲流量控制和拥塞控制

- 流量控制是为了解决两端缓冲区大小不一致，或者是两端数据处理能力的不一致而对发送的数据大小进行控制的一个机制，具体情况是当窗口大小不合适的时候，客户端会发送一次窗口探测数据包，看是否有机会调整窗口的大小，当服务器处理慢。会产生糊涂窗口综合症。
- 拥塞控制是为了处理网络环境不稳定导致的丢包和超时重传问题的。**端到端通道的容量=带宽*往返时间**。拥塞控制细节：一开始，进行慢启动，讲cwnd设置为1，一次只能发送一个包，之后每收到一个包，cwnd就加1，例如一开始是1，发一个包收到后为2，发两个包都收到就为4，这是指数增长，但是这样子又不太行，因为到最后很容易爆炸起来，就是堵塞了。假如我们数据过大的时候，再把窗口变为1，同时增量也变为1，这种方式虽然可以解决阻塞问题，但是容易造成网络不稳定，因为其是因为指数增长的，不需要要迭代几次就又会到达那个值。**因此，我们需要另外一种方式来解决，当慢启动之后数据大的情况，我们引入慢启动闸值的概念，超过这个闸值之后，慢启动的增长速度虽然和确认应答数目有关，但是其涨幅会大大减少。**
- 加法增大：也就是上一段中加黑部分。也就是说当超过闸值的时候窗口还是在变大的，但是变大的速率不再是指数增加了。
- 乘法减小：指的是当网络出现拥塞的情况：会将闸值除以二，同时，将窗口设置为1，重新开始慢启动。（这是在还未达到闸值之前）
- 快速重传机制：当客户端收到的报文段序号大于下一个期望的报文段序号时，就检测出了中间一个段没收到，从而发送3个冗余的ACK，服务端收到后，就重传丢失的报文段。
- 快速恢复机制，假如一次性收到了三个ack说明网络还不是那么拥塞，那么要合理的配置数据传送机制，将闸值设置为减半的窗口大小，同时将窗口大小变为闸值+3*报文长度，之后每收到一次ack，就cwnd加1。并且发送一个新的分组。可以说是在收到3个ack后，并不直接进入慢启动的一个算法，而是用一种比较温和的操作控制网络。

![preview](https://pic3.zhimg.com/v2-1ba5604ea0b53cd252833aa4a0671962_r.jpg)

### 5、一个TCP可以发送多少http请求

https://www.cnblogs.com/williamjie/p/11075565.html	这个也是重点。

### 6、MAC和IP地址和端口的区别

1、分配依据不同：对于网络中的一些设备，路由器或者是PC及而言，IP地址的设计是出于拓扑设计出来的，只要在不重复IP地址的情况下，它是可以随意更改的；而MAC地址是根据生产厂商烧录好的，它一般不能改动的，一般来说，当一台PC机的网卡坏了之后，更换了网卡之后MAC地址就会变了。

2、长度不同：在前面的介绍里面，它们最明显的区别就是长度不同，IP地址的长度为32位，而MAC地址为48位。

3、支持协议层不同：它们的寻址v协议层不同。IP地址应用于OSI模型的网络层，而MAC地址应用在OSI模型的数据链路层。 数据链路层协议可以使数据从一个节点传递到相同链路的另一个节点上（通过MAC地址），而网络层协议使数据可以从一个网络传递到另一个网络上（ARP根据目的IP地址，找到中间节点的MAC地址，通过中间节点传送，从而最终到达目的网络）。

4、MAC地址是为了去寻找下一个网关用的，就是当我们要找ip的时候，先去查找缓存中有没有改ip对应的mac有就跑去那个对应的mac地址上，没有就广播一下，看看其他网关有没有该ip地址，有就返回。一般会储存到ARP映射表中。

### 8、为什么要设置2MSL也就是TIME_WAIT

- 为了防止当客户端接收到第三次挥手的消息后，直接断开连接，然后突然有另外一个程序使用到该端口，造成数据混乱的情况。
- 也为了确保服务端那边能够接收到信息。
- 保证了全双工通信的终止。
- 允许老的重复分节在网络中的流失（为什么需要2MSL）

### 9、HTTPS和HTTP的区别

- https中的s是指ssl，http先和ssl通信，然后再由ssl与tcp通信，通过这样子的过程，https有了加密（防窃听）、认证（防伪装）和完整性保护（防篡改）
- HTTPS采用混合的加密机制，使用非对称密钥加密用于传输对称密钥来保证过程的安全性，之后用对称密钥加密进行通信来保证通信过程的效率。
- HTTPS比较慢，同时需要支付高额费用。
- git的一个免密登录就是使用了非对称加密

### 10、对称加密和非对称加密的优缺点

#### 对称加密

优点：对称加密运算速度快。

缺点：无法安全地将密钥传输给通信方。

- 如指纹，PIN，保险箱密码等。

#### 非对称又叫做公开密钥加密，加密和解密使用不同的密匙

- 公钥所有人都可以获得，通信发送方得获得接收方的公开密钥，就可以用公开密钥进行加密，接收方收到通信内容后使用私有密钥解密。
- 非对称密钥除了用来加密，还可以用来做签名，因为私有密钥无法被其他人获取，因此通信发送方使用私有密钥进行签名，通信接收方使用发送方的公开密钥对签名进行解密，就能判断这个签名是否正确。
- 优点：可以更安全地将公开密钥传输给通信发送方
- 缺点：运算速度慢

github中的`ssh-keygen` 程序指定加密算法为 rsa，ssh公钥。

### 11、请讲一下签名认证。

- 签名可以证明是作者1编写了这条报文。
- 签名可以防止报文被修改。

### 12、RST包

- 当服务器关闭的时候，会发出这个包。
- 当服务器认为请求超时的时候，会发出这个包。

### 13、为什么要三次握手四次挥手

https://blog.csdn.net/yu876876/article/details/81560122

- 为什么二次握手不行，因为二次握手无法保证SYN双方都收到，也就是说初始序列号无法达成一致，也就是说A发给B，这样子B能知道A接下去的序列号是啥，反过来假如没第三次握手，那么A无法了解到B的接下去的序列号是什么，因为中间可能丢包了。
- 会浪费资源，假如第一次握手的数据经过很久才发送到服务端上，那么当这个报文发到服务端上的时候，客户端已经不需要建立连接了，那么当服务端将第二次握手的报文发给客户端的时候，服务端就建立起连接，等待客户端回复，但是客户端是不需要连接的，所以客户端就丢弃该报文，导致了服务端一直在等待客户端发送数据。
- 保证双方都有发送和接收的能力。

- 三次握手是保证可靠性传输的最小次数，再多的次数也没多大作用，而且还会资源浪费。

### 14．为什么建立连接协议是三次握手，而关闭连接却是四次握手呢？

这是因为服务端的LISTEN状态下的SOCKET当收到SYN报文的连接请求后，它可以把ACK和SYN(ACK起应答作用，而SYN起同步作用)放在一个报文里来发送。但关闭连接时，当收到对方的FIN报文通知时，它仅仅表示对方没有数据发送给你了；但未必你所有的数据都全部发送给对方了，所以你可能未必会马上会关闭SOCKET,也即你可能还需要发送一些数据给对方之后，再发送FIN报文给对方来表示你同意现在可以关闭连接了，所以它这里的ACK报文和FIN报文多数情况下都是分开发送的。

### 15、HTTP2

- **http2采用的是二进制格式传输**，解析起来高效，而HTTP/2将请求和响应分割为更小的帧，并且采用二进制编码。

- **HTTP/2 中，同域名下所有通信都在单个连接上完成，该连接可以承载任意数量的双向数据流。**每个数据流都以消息的形式发送，而消息又由一个或多个帧组成。多个帧之间可以乱序发送，根据帧首部的流标识可以重新组装。

- **多路复用（多个请求在同一个TCP连接中发送）**

  多路复用，代替原来的序列和阻塞机制。所有就是请求的都是通过一个 TCP连接并发完成。 HTTP 1.x 中，如果想并发多个请求，必须使用多个 TCP 链接。
  
- **服务器推送**：在发送HTML页面的时候同时发送其他数据，例如JS等。

- 头部压缩

### 16、TCP的几种定时器

- https://blog.csdn.net/hyman_yx/article/details/52086389
- SYN定时器，确保建立连接的信号能发送到对方上去。
- 重传定时器，确保数据能够发送到对方去。
- 延迟应答定时器，一般是200ms为了能够将应答和数据一起发送，节约一个包。
- 坚持定时器，为了使得窗口控制能正常运行，假如接收端的窗口控制变为了0，那么在发送一个ACK确认报文大小的时候，这个ACK报文可能丢失，假如丢失了，如果没有这个定时器再次发送ACK的话，接受端在等待对方的数据，而对方在等待该ACK，造成死锁
- 保活定时器，用来确保对方还活着。
- FIN_WAIT_定时器，假如没能等来第三次挥手的到来的话，该定时器就会将连接关闭。
- 2MSL定时器，为了确保最后一次挥手能被对方收到，同时也为了防止老包在新连接出现导致错误。

### 17、HTTP的状态码

- 200-请求成功
- 202-请求成功，但是body无数据
- 204-请求成功，但是body并不是报文的全部
- 3xx-表重定向
- 301-表永久重定向，表示资源不存在了，需要改动URL再次访问。
- 302-表临时重定向，表示资源还在，但是需要用另外一个URL访问。
- 4xx-报文错误。
- 400-错误报文，但不知道情况
- 403-服务器禁止访问
- 404-资源没找到
- 5xx-服务器处理发生错误。
- 500-服务器发生错误，但不知道情况。
- 501-表客户端请求的功能还不支持。
- 502-表服务器工作正常，访问后端服务器发生了错误。
- 503-服务器繁忙。

### 18、HTTP的字段有哪些

- HOST:表示访问的域名
- Content-Length:表示回应长度
- Connection:字段用于客户端要求服务器使用TCP持久连接，以方其他请求复用。
  - HTTP/1.1版本的默认连接是持久连接，为了兼容老版本，需要指定Connection字段为keep-alive。
- Content-Type:表示此次是什么数据类型。html啊之类的
- Content-Encoding:表示用的是什么压缩方式

### 19、get和post的区别

- get的含义是请求从服务器获取资源，这个资源可以是静态的如文本视频等。
- post则相反，它向uri所在的地方提交数据，数据在body里。
- get是安全且幂等的，而post是不安全且不幂等的。

### 20、HTTP有哪些优点缺点

- 简单，报文格式为header+body，头部信息也是key-value的形式。
- 灵活且易于扩展，各种字段要求没有被固定，可以由开发人员自己定义和扩充。如HTTPS。
- 应用广泛且跨平台，手机和PC端都可以用。

- 无状态，好处：服务器不需要去记录HTTP状态，能减少服务器负担。坏处，有关联性的操作会很麻烦。解决方法，cookie技术：在客户端第1次请求后，服务器会下发⼀个装有客户信息的「⼩贴纸」，后续客户端请求服务器的时候，带上「⼩贴纸」，服务器就能认得了.
- 明文传输
- 不安全：使用明文，不验证省份，无法证明报文完整性。

#### 风险

- 窃听，获取密码---	信息加密--- 混合加密
- 冒充，冒充淘宝---    校验机制--- 摘要算法实习完整性，明文的指纹。
- 篡改，植入广告---    身份证书--- 公钥放到数字证书中，解决冒充风险。
- 

### 21、HTTP1.1比1.0有啥提升

#### 性能

- 长连接（持久连接）：减少了TCP连接的重复建立和断开额外开销，减去了服务器端的负载。
- 管道网络传输：可以同时发送两个请求，假如前面回复的慢，就会造成对头阻塞。
- HTTP1.1：
  - 请求/响应头部未经压缩就发送，首部信息越多延迟越越大。只能压缩body的部分。
  - 发送冗长的首部。每次互相发送相同的首部造成的浪费较多。
  - 服务器是按请求响应的，如果服务器响应慢，会导致一些客户端一直收不到数据，也就是对头阻塞。
  - 没有优先级控制。
  - 请求只能从客户端开始，服务器只能被动响应。

### 22、HTTP2对比HTTP1.1

- 头部压缩：HPACK算法，维护一张头部信息表，所有字段都存入这个表，生成一个索引号，以后就不发送相同字段，只发送索引，提高了速度。
- 二进制格式：头部和信息体都是二进制，统称为帧，头信息和数据帧。收到报文后，无需转为二进制，而是直接解析二进制报文。
- 数据流：HTTP/2数据包不是按照顺序发送的，同一个连接里面连续的数据包可能属于不同的回应，因此，必须要对数据包做标记，指出它属于哪个回应。每个数据流都标记。规定客户端为奇数，服务端为偶数。还可以执行数据流优先级。
- 多路复用：可以在一个连接中并发多个请求或者回应，而不用按照顺序一一对应，移除了HTTP/1.1的串行请求，不需要排队等待，也就不会出现队头阻塞问题，降低了延迟，提高了连接的利用率。也是就说可以在AB请求过程中，处理A然后B然后再A这种情况发送它与HTTP1.1中的管道通信机制的差别就是它不需要按顺序接受，也就是不会有队头阻塞的情况。当丢包的时候，会阻塞所有的HTTP请求。
- 服务器推送：在浏览HTML的同时把可能用到的静态资源推送过去，减少延迟。

### 23、HTTP2到HTTP3的区别

- HTTP3为了解决HTTP1的对头阻塞以及多路复用的时候的丢包问题，讲传输层变成了udp，采用QUIC协议。
- QUIC有自己的一套机制保证传输的可靠性，丢包时只会阻塞这个流，其他流不受到影响。
- 普通的HTTPS需要6次交互，先三次握手，然后TLS/1.3的三次握手。
- 而QUIC直接把6次合并为3次，减少了交互次数。

### 24、IP地址分为下面5类

A类：0，B类：10，C类，110，D类，1110，E类，11110。	

区分为网络号主机号，主机号全1表示该网络下的所有主机，全0表示该网络。

- 广播有本地广播和直接广播：
  - 本地广播：例如⽹络地址为 192.168.0.0/24 的情况下，⼴播地址是192.168.0.255 。因为这个⼴播地址的 IP 包会被路由器屏蔽，所以不会到达 192.168.0.0/24 以外的其他链路上。
  - 直接广播：在不同⽹络之间的⼴播叫做直接⼴播。例如⽹络地址为 192.168.0.0/24 的主机向 192.168.1.255/24的⽬标地址发送 IP 包。收到这个包的路由器，将数据转发给 192.168.1.0/24，从⽽使得所有192.168.1.1~192.168.1.254 的主机都能收到这个包

### 25、IPv6有啥两点

- IPv6可以自动配置，可以即插即用。
- IPv6首部长度采用固定的值40字节。
- IPv6有应对伪造IP地址的网络安全功能以及防止线路窃听的功能。

**IPv6 相⽐ IPv4 的⾸部改进：**

- 取消了⾸部校验和字段。 因为在数据链路层和传输层都会校验，因此 IPv6 直接取消了 IP 的校验。

- 取消了分⽚**/**重新组装相关字段。
- 取消选项字段

### 24、琐碎知识点

##### ARP协议(借助了ARP请求和ARP响应)

- 在主机ARP高速缓存中存放一个从IP地址到硬件地址的映射表。
  - 每次发送到目的IP的时候，先查找主机ARP高速缓存中有无该IP地址，有就将其对应的MAC地址写入MAC帧。
  - 假v如找不到该IP地址，就在本局域网上广播一个ARP请求分组，内容为本机的IP和MAC，还有目的地址，本局域网上的所有主机上运行的ARP进程都受到此ARP请求分组，假如有主机的IP地址与ARP请求分组中的IP地址一致，就收下这个ARP请求分组，并向主机发送ARP响应分组，同时在ARP响应分组中写入自己的硬件地址，同时在本机缓存中写入A的IP和MAC地址。假如不一致，就不理睬。发送主机收到后就把接收主机的IP到MAC的映射写到ARP缓存中。 
  - ARP高速缓存会对每一个映射项目设置生存时间，一旦超过时间，就从高速缓存中删除。

- IP数据报格式
  - 版本，首部长度，区分服务，总长度（首部数据+数据之和的长度）MTU(1500字节)，标识（标识该分片为哪个数据报的分片），片偏移（相对于原分组中的相对位置），生存时间（TTL，跳数次数），协议（UDP，TCP），首部校验和，源地址和目的地址。
- 分组转发算法：
  - 在路由表中，先从数据报首部提取目的主机的IP地址D，得出目的的网络地址为N。
  - 若N为此路由器相连的某个网络地址，则进行直接交付，否则就若路由表中有目的地址为D的特定主机路由，则把数据报发送给路由表中所指明的下一跳路由器，否则若路由表中有到达网络N的路由，则把数据传送给路由表中所指明的吓一跳路由，否则跳转到默认路由。
- 使用子网时的分组转发
  - 与本网络的子网掩码进行与操作，查看是否当前网络，是就交付。
  - 若路由表中有目的地址为D的特定主机路由，就把数据传送给路由表中所指明的下一跳路由器，若没有就下一步
  - 对路由表中的每一行用其子网掩码和D逐位与，结果为N。若N与改行的目的网络地址匹配，就把数据报传送给该行指明的下一跳路由器，否则，跳去默认路由。

- RARP是请求自己的IP地址。

##### DHCP

- 通过DHCP动态获取IP地址。

##### NAT

- 也就是将不同ip地址对外显示为不同端口但同ip地址的形式。
  - 缺点外部无法与内部节点进行连接，因为NAPT转换表没有转换记录。
  - 转换表生成与转换操作都会产生性能开销。
  - 如果NAT路由器重启了，所有的TCP都将被重置。
- 改进方法：
  - IPv6：普及需要时间。
  - NAT穿透技术：让网络应用程序主动发现自己位于NAT设备之后，会主动获得NAT设备的公有IP，并为自己建立端口映射条目，这些是NAT设备后的应用程序自动完成的。NATA设备后的应用程序处于主动地位，主动配合NAT设备的操作，主动建立浩映射。也就是将映射过程放在网络应用程序本身实现。

### Ping的原理（ICMP）

- 互联网控制报文协议（是在IP报文里面的）
- 确认IP包是否能成功送达到目标地址，报告发送过程中IP包被废弃的原因和改善网络设置等。
  - 查询报文类型
  - 差错报文类型

tracerout利用IP包的声明周期从1开始按照顺序递增的同时发送UDP包，强制接受ICMP超时消息的一种方法。

traceroute另外一个作用是故意设置不分片，从而确定路径的MTU。也就是先发送一个UDP，如果过大，丢包，然后返回一个ICMP报文，通知MTU大小，由于UDP中没有重发处理，应用在发送下一个消息时才会被分片。具体来说，就是指UDP传过去的【UDP首部和UDP数据】在IP层被分片。对于IP，它不区分UDP首部和应用的数据。到达后重组，再传给接受主机的UDP层。

https://zhuanlan.zhihu.com/p/36811672



### 25、TCP

- 序列号：用来解决网络包乱序问题。
- 确认应答号：用来解决不丢包问题。
- 可靠的，有连接的，字节流的传输层通信协议。

### 26、ARQ协议

- 自动重传请求，发送了没收到确认就会重新发送。停止等待ARQ和连续ARQ协议。

### 27、网卡，网桥，路由器和4~7层交换机和网关

- 网卡是只要有ip地址就需要这个东西，这个东西是拿来分配ip地址的。
- 网桥是用来连接同一网络内的不同局域网的。
- 路由器是用来连接不同网络的。
- 4~7层交换机可以举个理解就是负载均衡服务器之类的。
- 网关是用来解决不同客户端之间数据转换问题，或者说当作一个中间加工的层分。

### 28、为什么有了IP地址还要有MAC地址

- 整理和局部（ip地址是知道终点地址，MAC地址是知道下一跳地址）
- 分层实现（网络层用ip地址，数据链路层用MAC地址，换的话只换一层，可以互不影响）

### 29、MTU和MSS

- MTU为最大传输窗口，默认为1500byte
- MSS为为最大报文长度，也就是，MTU减去一些必须的东西（ip报文头和TCP报文头）