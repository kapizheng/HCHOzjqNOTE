### redis为什么那么快

- IO多路复用，非阻塞IO，基于内存，单线程，数据结构简单。

### redis的数据类型

- string，字符串，整数或者浮点
- List，列表
- SET，无序集合
- HASH，包含键值对的无序列散列表
- ZSET，有序集合，去重可排序。

### redis的应用场景

- 计数器，缓存，会话缓存，消息队列，分布式锁

### redis持久化

##### RDB持久化

- RDB持久化可以通过SAVE或者BGSAVE进行，也可以在配置文件中设置定时规则。SAVE使用的时候会阻塞，而BGSAVE是会另外开一个子进程进行的。
  - BGSAVE执行过程，SAVE会被服务器拒绝，BGSAVE会被服务器拒绝，两者都是怕发生竞争条件。
  - BGREWRITEAOF和BGSAVE不能同时进行
    - 假如BGSAVE正在执行，那么客户端发送的BGREWRITEAOF会被延迟到BGSAVE结束后执行。
    - 假如BGREWRITEAOF正在执行，那么BGSAVE会被服务器拒绝。
- RDB持久化的载入是在程序启动的时候发生的。
- 假如开启了AOF持久化功能，那么服务器会优先使用AOF文件来还原数据库状态。除非AOF持久化关闭了，数据库才会使用RDB文件来还原数据库状态。载入过程会处于阻塞状态。
- RDB持久化，假如是在配置文件中设置的话，内部就会产生一个saveparam数组。

##### AOP持久化

- AOF持久化功能的实现可以分为命令追加，文件写入，文件同步三个步骤。

- 伪客户端（fake client）来实现AOF文件的载入。
- AOF的重写会去除一些冗余的指令。
- AOF重写缓冲区会在子进程进行重写的时候收集父进程的写入命令。